{
  "project": "Muldoon",
  "branchName": "ralph/item-image-upload",
  "description": "Item Image Upload - Add react-dropzone to admin item form for product image uploads with Supabase Storage",
  "userStories": [
    {
      "id": "US-001",
      "title": "Create Supabase Storage bucket and policies",
      "description": "As a developer, I need a Supabase Storage bucket with proper policies to store product images.",
      "acceptanceCriteria": [
        "Create SQL migration that creates 'product-images' storage bucket",
        "Configure bucket with public read access policy (anyone can view images)",
        "Configure authenticated upload policy (only authenticated users can upload)",
        "SQL migration file created in supabase/migrations/",
        "Typecheck passes"
      ],
      "priority": 1,
      "passes": true,
      "notes": "Completed migration: 20260115184437_create_product_images_bucket.sql"
    },
    {
      "id": "US-002",
      "title": "Add react-dropzone to item form",
      "description": "As an admin, I want to drag-and-drop an image onto the item form so I can easily add product photos.",
      "acceptanceCriteria": [
        "Install react-dropzone package",
        "Add dropzone component at the top of ItemForm (before Name field)",
        "Dropzone accepts any image type (image/*) with no size limit",
        "Dropzone shows visual feedback on drag hover (dashed border, background change)",
        "Clicking the dropzone opens file picker",
        "Use Lucide Upload icon in dropzone placeholder",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 2,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-003",
      "title": "Display image preview with remove option",
      "description": "As an admin, I want to see a preview of the selected/existing image and be able to remove it.",
      "acceptanceCriteria": [
        "Show thumbnail preview of selected image file (max 200x200, preserve aspect ratio)",
        "Show existing image from item.imageUrl when editing an item",
        "Display 'Remove' button (X icon) on image preview",
        "Clicking remove clears the selected image and marks for deletion",
        "When no image selected, show placeholder with dashed border and upload instructions",
        "Track state: newFile (File | null), existingUrl (string | null), shouldDelete (boolean)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 3,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-004",
      "title": "Upload image on form submit",
      "description": "As an admin, when I submit the item form, the image should be uploaded to Supabase Storage and the database should be updated.",
      "acceptanceCriteria": [
        "Modify updateItem server action to accept image file in FormData",
        "On submit with new image: upload to product-images bucket at path items/{itemId}/{filename}",
        "Generate public URL using supabase.storage.from().getPublicUrl()",
        "Update imageStoragePath with storage path and imageUrl with public URL",
        "If image removed (shouldDelete true): delete old image from storage, set columns to null",
        "If no image change: preserve existing values",
        "Show loading state during form submission",
        "Handle upload errors with user-friendly message",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 4,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-005",
      "title": "Handle image upload for new items",
      "description": "As an admin, when I create a new item with an image, it should be uploaded correctly.",
      "acceptanceCriteria": [
        "Modify createItem server action to accept image file in FormData",
        "After item insert, use new item ID to upload image to items/{itemId}/{filename}",
        "Update the newly created item record with imageStoragePath and imageUrl",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 5,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-006",
      "title": "Display product images in storefront",
      "description": "As a customer, I want to see product images on the product cards.",
      "acceptanceCriteria": [
        "Update ProductCard component to display imageUrl when available",
        "Use Next.js Image component for optimized loading",
        "Show placeholder image or icon when no imageUrl exists",
        "Images properly sized and don't break card layout",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 6,
      "passes": false,
      "notes": ""
    }
  ]
}
